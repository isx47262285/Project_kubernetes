<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Roberto Altamirano Martínez" />
  <title>Kubernetes (K8S)</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="https://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="style.css" />
  <script src="https://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Kubernetes (K8S)</h1>
  <p class="author">
Roberto Altamirano Martínez
  </p>
</div>
<div class="slide" id="TOC">
<ul>
<li><a href="#índice">Índice</a></li>
<li><a href="#introducción">Introducción</a></li>
<li><a href="#puntos-a-destacar">Puntos a destacar</a></li>
<li><a href="#puntos-a-destacar-1">Puntos a destacar</a></li>
<li><a href="#puntos-a-destacar-2">Puntos a destacar</a></li>
<li><a href="#estructura-kubernetes">Estructura Kubernetes</a></li>
<li><a href="#estructura-kubernetes-1">Estructura Kubernetes</a></li>
<li><a href="#esctructura-del-proyecto">Esctructura del proyecto</a></li>
<li><a href="#esctructura-del-proyecto.">Esctructura del Proyecto.</a></li>
<li><a href="#esctructura-del-proyecto.-1">Esctructura del Proyecto.</a></li>
<li><a href="#estructura-del-proyecto.">Estructura del Proyecto.</a></li>
<li><a href="#el-cluster">El cluster</a></li>
<li><a href="#el-cluster-1">El Cluster</a></li>
<li><a href="#el-cluster-2">El Cluster</a></li>
<li><a href="#el-cluster-3">El Cluster</a></li>
<li><a href="#el-cluster-4">El Cluster</a></li>
<li><a href="#el-cluster-5">El Cluster</a></li>
<li><a href="#pasamos-a-la-demostración">Pasamos a la Demostración</a></li>
</ul>
</div>
<div id="índice" class="slide section level1">
<h1>Índice</h1>
<ul>
<li>Introducción</li>
<li>Puntos a Destacar</li>
<li>Estructura de Kubernetes</li>
<li>Estructura del Proyecto</li>
<li>El Cluster</li>
<li>Demostración</li>
</ul>
</div>
<div id="introducción" class="slide section level1">
<h1>Introducción</h1>
<p><strong>¿Qué es Kubernetes?</strong></p>
<p>Kubernetes fue originalmente un proyecto creado por Google, el cual tiene experiencia de más de 15 años gestionando contenedores. Ahora se trata de un proyecto de código abierto, bajo el paraguas de <em>Cloud Native Computing Foundation (CNCF) y la Fundación Linux</em>.</p>
<p><strong>¿Qué significa Kubernetes? ¿Qué significa K8S?</strong></p>
<p>El nombre Kubernetes proviene del griego y significa timonel o piloto. Es la raíz de gobernador y de cibernética. <strong>K8s</strong> es una abreviación que se obtiene al reemplazar las ocho letras “ubernete” con el número <strong>8</strong>.</p>
</div>
<div id="puntos-a-destacar" class="slide section level1">
<h1>Puntos a destacar</h1>
<p><strong>Ventajas de usar esta tecnología.</strong></p>
<ul>
<li>Orquestación de contenedores en múltiples hosts, ya que no utiliza contenedores como tal, sino que utiliza agrupaciones de contenedores, lo que se conoce como Pod.</li>
<li>Escalado y auto-escalado: en función del uso de CPU permite el escalado vertical de tus aplicaciones de manera automática o de forma manual.</li>
<li>Permite optimizar recursos, definiendo dentro de los Pods qué recursos va a necesitar cada contenedor, como puede ser la cuota de disco duro o el límite de memoria RAM que utilice el propio contenedor.</li>
<li>Autorreparación: en caso de fallo de un contenedor puede reiniciarlo automáticamente. Puede reemplazar o replanificar contenedores cuando un nodo muere.</li>
<li>Podemos automatizar despliegues, saneamientos de contenedores, subida de versión de aplicaciones y un sinfín de cosas más.</li>
</ul>
</div>
<div id="puntos-a-destacar-1" class="slide section level1">
<h1>Puntos a destacar</h1>
<p><strong>¿Donde se puede utilizar Kubernetes?</strong></p>
<p>Las opciones para utilizar Kubernetes apenas tienen restricción.</p>
<ul>
<li><strong>Bare Metal</strong>: podemos desplegar nuestro cluster directamente sobre máquinas físicas utilizando múltiples sistemas operativos: Fedora, CentOS, Ubuntu, etc.</li>
<li><strong>Virtualización On Premise</strong>: si queremos montar nuestro cluster on premise, pero con máquinas virtuales, las posibilidades crecen. Podemos utilizar Vagrant, CloudStack, Vmware, OpenStack, CoreOS, oVirt, Fedora, etc.</li>
<li><strong>Soluciones Cloud</strong>: Google Container Engine, Azure, IBM, Kube2Go, Kops (AWS)</li>
</ul>
</div>
<div id="puntos-a-destacar-2" class="slide section level1">
<h1>Puntos a destacar</h1>
<p><strong>Evolución de la tecnología informática</strong></p>
<ul>
<li>Conforme al paso del tiempo las nuevas tecnologías han evolucionado y han cambiado el mundo de la informática pasando de:</li>
</ul>
<p>Servidores físicos –&gt; Servicios Cloud</p>
<p><img src="evolution.png" /></p>
</div>
<div id="estructura-kubernetes" class="slide section level1">
<h1>Estructura Kubernetes</h1>
<p><strong>Estructura de un Cluster</strong></p>
<p><img src="cluster.png" /></p>
</div>
<div id="estructura-kubernetes-1" class="slide section level1">
<h1>Estructura Kubernetes</h1>
<p><strong>Conceptos de Kubernetes.</strong></p>
<ul>
<li><strong>Deployment</strong>: Una implementación proporciona actualizaciones declarativas para Pods y ReplicaSets.</li>
<li><strong>Service</strong>: Una forma abstracta de exponer una aplicación que se ejecuta en un conjunto de Pods como un servicio de red.</li>
<li><strong>Pod</strong>: es la unidad de ejecución básica de una aplicación de Kubernetes, la unidad más pequeña y más simple en el modelo de objetos de Kubernetes que crea o implementa. Un Pod representa procesos que se ejecutan en su racimo.</li>
<li><strong>Nodo</strong>: nodo contiene los servicios necesarios para ejecutar Pods, incluye el kubelet, container runtime, kube-proxy.</li>
<li><strong>Master</strong>: es el responsable de mantener el estado deseado de tu clúster. Cuando interactúas con Kubernetes, por ejemplo: la línea de comandos kubectl, es la comunicación directa con el master de tu clúster de Kubernetes.</li>
</ul>
</div>
<div id="esctructura-del-proyecto" class="slide section level1">
<h1>Esctructura del proyecto</h1>
<p><strong>El proyecto</strong></p>
<p>Este proyecto necesita varios componentes para su simulación.</p>
<ul>
<li><strong>Minikube</strong>: Cluster de Kubernetes.</li>
<li><strong>Hypervisor</strong>: VirtualBox, KVM, Docker, Hyper-V, etc</li>
<li><strong>Kubectl</strong>: linea de comandos cliente.</li>
<li><strong>imagenes</strong>: Biblioteca DockerHub (por defecto), pero nos sirve cualquier imagen.</li>
</ul>
</div>
<div id="esctructura-del-proyecto." class="slide section level1">
<h1>Esctructura del Proyecto.</h1>
<p><img src="objects.png" /></p>
</div>
<div id="esctructura-del-proyecto.-1" class="slide section level1">
<h1>Esctructura del Proyecto.</h1>
<p><strong>Esctructura de Gandhi K8S.</strong></p>
<p><strong>Servers</strong></p>
<ul>
<li>Servicio LDAP</li>
<li>Servicio KRB5</li>
<li>Servicio SAMBA</li>
<li>Servicio NFS</li>
</ul>
<p><img src="cluster-vacio.png" /></p>
</div>
<div id="estructura-del-proyecto." class="slide section level1">
<h1>Estructura del Proyecto.</h1>
<p><strong>Estructura del Host</strong></p>
<p>Utilizaremos dos containers Docker para simular un host que hará la conexión con Gandhi K8S y validara un usuario de la escuela con sus credenciales.</p>
<p>Tenemos dos versiones de los clientes:</p>
<ul>
<li><p>Container <strong>host-samba</strong></p>
<p>Responsable de montar la zona de trabajo (home) vía <strong>cifs</strong>.</p></li>
<li><p>Container <strong>host-nfs</strong></p>
<p>Responsable de montar la zona de trabajo (home) vía <strong>nfs</strong>.</p></li>
</ul>
</div>
<div id="el-cluster" class="slide section level1">
<h1>El cluster</h1>
<p><strong>¿como inicio mi cluster?</strong></p>
<pre><code>minikube start </code></pre>
<p>Nombraremos las dos opciones utilizadas para desarrollar nuestro proyecto:</p>
<ul>
<li><code>--driver=</code></li>
</ul>
<p>Nos permite especificar el hypervisor con el que vamos arrancar nuestro cluster</p>
<ul>
<li><code>--extra-config=apiserver.service-node-port-range=7-30000</code></li>
</ul>
<p>Nos permite abrir un rango de puertos diferente al que usa por defecto minikube.</p>
</div>
<div id="el-cluster-1" class="slide section level1">
<h1>El Cluster</h1>
<p><strong>¿ Que puedo hacer en minikube ?</strong></p>
<p>Ordenes para inspeccionar/interactuar con nuestro cluster.</p>
<pre><code>minikube version
minikube status
minikube ip
minikube ssh</code></pre>
</div>
<div id="el-cluster-2" class="slide section level1">
<h1>El Cluster</h1>
<p>Minikube tiene su entorno web para poder inspeccionar la estructura del cluster.</p>
<pre><code>minikube dashboard</code></pre>
<div class="figure">
<img src="ui-dashboard.png" alt="alt cloud" />
<p class="caption">alt cloud</p>
</div>
</div>
<div id="el-cluster-3" class="slide section level1">
<h1>El Cluster</h1>
<p><strong>¿Que puedo hacer en un cluster de minikube?</strong></p>
<p><strong>Crear un Deployment</strong></p>
<pre><code>kubectl create deployment http-prova --image=robert72004/http-prova:minikube</code></pre>
<p><strong>Crear un Service</strong></p>
<pre><code>kubectl expose deployment http-prova --type=NodePort</code></pre>
</div>
<div id="el-cluster-4" class="slide section level1">
<h1>El Cluster</h1>
<p><strong>¿Que puedo hacer en un cluster de minikube?</strong></p>
<p><strong>Escalar un Deployment</strong></p>
<pre><code>kubectl scale deployment http-prova --replicas=2 </code></pre>
<p><strong>Actualizar un Deployment</strong></p>
<pre><code>kubectl set image deployments/http-prova http-prova=robert72004/http-prova:minikubeV2</code></pre>
</div>
<div id="el-cluster-5" class="slide section level1">
<h1>El Cluster</h1>
<p><strong>monitorizar un deployment, pod o service</strong></p>
<pre><code>kubectl describe deployments.apps http-prova 
kubectl describe pod http-prova
kubectl describe service http-prova</code></pre>
<p><strong>Interactuar con un Pod</strong></p>
<pre><code>kubectl exec -it http-prova /bin/bash</code></pre>
</div>
<div id="pasamos-a-la-demostración" class="slide section level1">
<h1>Pasamos a la Demostración</h1>
<p><img src="saludos.gif" /></p>
</div>
</body>
</html>
